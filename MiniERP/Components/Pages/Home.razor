@page "/"
@using MiniERP.Database.Models
@using Microsoft.AspNetCore.Components.QuickGrid

<div class="container-main">
	<div class="home-title">
		<h1>HOME</h1>
	</div>
	<div class="grid-container">
		<QuickGrid Items="Users">
			<TemplateColumn Title="Id">
				<label class="user-id">
					@context.Id
				</label>
			</TemplateColumn>
			<TemplateColumn Title="ProfileImg">
				<div class="td-container">
					@if (context.Id != 0)
					{
						<div class="container-users">
							<a href="/login/@context.Id">
								<img src="@(context.ProfileImg is null ? "img/default.png"
									: $"data:image/png;base64,{Convert.ToBase64String(context.ProfileImg)}")" class="user-image" />
							</a>
							<div>
								<a href="/register/@context.Id" class="btn-edit-overlay">
									<i class="far fa-edit"></i>
								</a>
							</div>
						</div>
					}
					else
					{
						<div class="add-user">
							<a href="/login/-1">
								<i class="fas fa-plus-circle"></i>
								<p>Add New User</p>
							</a>
						</div>
					}
				</div>
			</TemplateColumn>
			<PropertyColumn Property="@(p => p.Name)" Sortable="false" />
		</QuickGrid>
	</div>

</div>

@code {
	[CascadingParameter]
	public bool ShowReturnButton { get; set; }
	private IQueryable<User> Users;

	protected override async Task OnInitializedAsync()
	{
		List<User> usersList = await new MiniERP.Database.Services.Users.UserService().GetUsers();

		usersList.Add(new User
		{
			Id = 0
		});
		Users = usersList.AsQueryable();

		ShowReturnButton = false;

	}

}